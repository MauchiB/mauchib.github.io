<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jarvis Botz Web</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: var(--tg-theme-bg-color, #f0f2f5);
            color: var(--tg-theme-text-color, #222);
        }
        .chat-card {
            background-color: var(--tg-theme-secondary-bg-color, #ffffff);
            transition: all 0.2s;
        }
        .chat-card:active {
            background-color: var(--tg-theme-hint-color, #e5e7eb);
            transform: scale(0.98);
        }
        .accent-text { color: var(--tg-theme-button-color, #3390ec); }
        .hint-text { color: var(--tg-theme-hint-color, #8e8e93); }
        .badge { background-color: var(--tg-theme-button-color, #3390ec); color: var(--tg-theme-button-text-color, #fff); }
    </style>
</head>
<body class="p-4 font-sans antialiased">

    <header class="mb-6 flex items-center justify-between">
        <div>
            <h1 class="text-2xl font-bold">–ß–∞—Ç—ã</h1>
            <p class="hint-text text-sm">–¢–≤–æ–∏ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã</p>
        </div>
        <div id="avatar" class="w-12 h-12 rounded-full border-2 border-blue-500 overflow-hidden bg-gray-200">
            <img id="user-photo" src="https://ui-avatars.com/api/?name=User" alt="Avatar">
        </div>
    </header>

    <div id="chat-list" class="space-y-3">
        </div>

    <div id="empty-state" class="hidden text-center py-20">
        <p class="hint-text">–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // –î–∞–Ω–Ω—ã–µ (–ø–æ–∑–∂–µ —Ç—ã –±—É–¥–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ fetch —Å FastAPI)
        const mockChats = [
            { id: '1', name: 'Jarvis GPT-4o', lastMsg: '–ß–µ–º —è –º–æ–≥—É –≤–∞–º –ø–æ–º–æ—á—å —Å–µ–≥–æ–¥–Ω—è?', time: '12:45', unread: 2, icon: 'ü§ñ' },
            { id: '2', name: 'Claude 3.5 Sonnet', lastMsg: '–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω.', time: '–í—á–µ—Ä–∞', unread: 0, icon: 'üß†' },
            { id: '3', name: 'DALL-E 3 Artist', lastMsg: '–ö–∞—Ä—Ç–∏–Ω–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞!', time: '–ü–Ω', unread: 0, icon: 'üé®' },
            { id: '4', name: 'DeepSeek Coder', lastMsg: '–û—à–∏–±–∫–∞ –≤ 45 —Å—Ç—Ä–æ–∫–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞.', time: '01.01', unread: 0, icon: 'üíª' }
        ];

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —á–∞—Ç–∞
        function renderChats(chats) {
            const container = document.getElementById('chat-list');
            container.innerHTML = '';

            chats.forEach(chat => {
                const card = document.createElement('div');
                card.className = 'chat-card flex items-center p-4 rounded-2xl shadow-sm cursor-pointer';
                card.onclick = () => selectChat(chat.id);

                card.innerHTML = `
                    <div class="text-3xl mr-4 bg-gray-100 w-12 h-12 flex items-center justify-center rounded-xl">
                        ${chat.icon}
                    </div>
                    <div class="flex-1 overflow-hidden">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-semibold truncate">${chat.name}</h3>
                            <span class="hint-text text-xs">${chat.time}</span>
                        </div>
                        <p class="hint-text text-sm truncate">${chat.lastMsg}</p>
                    </div>
                    ${chat.unread > 0 ? `<span class="badge ml-3 px-2 py-0.5 rounded-full text-[10px] font-bold">${chat.unread}</span>` : ''}
                `;
                container.appendChild(card);
            });
        }

        // –î–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —á–∞—Ç
        function selectChat(id) {
            tg.HapticFeedback.impactOccurred('medium');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º ID –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —á–∞—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ –±–æ—Ç—É
            tg.sendData(JSON.stringify({ action: 'select_chat', chat_id: id }));
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ TG
        if (tg.initDataUnsafe.user) {
            const user = tg.initDataUnsafe.user;
            document.getElementById('user-photo').src = user.photo_url || `https://ui-avatars.com/api/?name=${user.first_name}`;
        }

        // –ó–∞–ø—É—Å–∫
        renderChats(mockChats);

    </script>
</body>
</html>
